{
  "updatedAt": "2025-10-16T01:34:34.000Z",
  "createdAt": "2025-10-16T00:59:47.821Z",
  "id": "yZzlCGfBVBt4C51h",
  "name": "Day 17 Part 2 User Erasure Request",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "right-to-erasure",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        0,
        0
      ],
      "id": "4d37a0fe-dfb4-44f8-91f2-d77a4dc2a790",
      "name": "User Erasure Request",
      "webhookId": "5ab8b716-5836-4c5f-aa90-700fb9091782"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1qbDDKtyjUWyWS75GamxN1iFBh4elxfd6U__QSHdHl4w",
          "mode": "list",
          "cachedResultName": "Ark-x Days",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qbDDKtyjUWyWS75GamxN1iFBh4elxfd6U__QSHdHl4w/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 586140462,
          "mode": "list",
          "cachedResultName": "marketing subscribers",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qbDDKtyjUWyWS75GamxN1iFBh4elxfd6U__QSHdHl4w/edit#gid=586140462"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "email",
              "lookupValue": "={{ $json.body.email }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        416,
        0
      ],
      "id": "e7cb8c57-c3cd-4366-a5e5-abc740289aaa",
      "name": "Find User",
      "retryOnFail": false,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "jToedYDz95w6z3tL",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "1qbDDKtyjUWyWS75GamxN1iFBh4elxfd6U__QSHdHl4w",
          "mode": "list",
          "cachedResultName": "Ark-x Days",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qbDDKtyjUWyWS75GamxN1iFBh4elxfd6U__QSHdHl4w/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 586140462,
          "mode": "list",
          "cachedResultName": "marketing subscribers",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1qbDDKtyjUWyWS75GamxN1iFBh4elxfd6U__QSHdHl4w/edit#gid=586140462"
        },
        "startIndex": "={{ $json.rowNumber }}",
        "numberToDelete": "=1"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1008,
        -160
      ],
      "id": "b11e4b25-0a7d-47cf-9373-6fc5cf354fb1",
      "name": "Delete User Row",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "jToedYDz95w6z3tL",
          "name": "Google Sheets account 5"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// n8n Function Node — Extract first row_number from input items\n\nconst items = $input.all();\n\nlet result = {\n  found: false,\n  rowNumber: null,\n  rawPreview: null,\n};\n\n// Loop through all input rows\nfor (let i = 0; i < items.length; i++) {\n  const row = items[i].json;\n  if (!result.rawPreview) result.rawPreview = row;\n\n  // Case 1: row_number directly present\n  if (row && row.row_number !== undefined && row.row_number !== null) {\n    result.found = true;\n    result.rowNumber = row.row_number;\n    break;\n  }\n}\n\n// Return the first found row number (or none)\nreturn [{ json: result }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        624,
        0
      ],
      "id": "335e419e-cbcf-459d-a3a2-0be847c4cfa6",
      "name": "Extract Row Number"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "21c18e07-6c7e-41e8-beb0-e058f5228cd4",
              "leftValue": "={{ $json.found }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        800,
        0
      ],
      "id": "026c0a2d-542b-4510-b9ff-cad810365c35",
      "name": "Check Deletion"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        1456,
        -160
      ],
      "id": "c1a30fb6-fa18-4b9d-b61e-f85b51cd198b",
      "name": "Send Confirmation Message"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        1472,
        96
      ],
      "id": "2537b2cc-1dec-4bc7-affc-64446d74e153",
      "name": "Send Confirmation Message1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "08b78db4-53e3-4ce2-b935-6f64ed274ec9",
              "name": "message",
              "value": "✅ Your data has been permanently deleted as per your request. Thank you for exercising your privacy rights.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1248,
        -160
      ],
      "id": "90e6839c-5a06-4faf-b2af-55f94db1c7e4",
      "name": "Webhook Reply Message"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "eebce2d6-22ed-433d-84da-1d6052e09826",
              "name": "message",
              "value": "⚠️ We could not find your email in our database. Please double-check and try again.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1008,
        96
      ],
      "id": "014aa9b2-34ca-4f8f-adbd-cac780a9f326",
      "name": "Webhook Reply Message1"
    },
    {
      "parameters": {
        "sendTo": "{{ $('Save Email').item.json.body.email }}",
        "subject": "=from form submission ",
        "message": "={{ $json.message }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1664,
        -160
      ],
      "id": "fe00e8f9-65bf-4397-9221-b191cabf5482",
      "name": "Send a message",
      "webhookId": "55932d3f-e940-4406-bc45-18e83da698b4",
      "credentials": {
        "gmailOAuth2": {
          "id": "kwQyExBG7xNmebmA",
          "name": "Gmail account 4"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "abffa367-aedf-420a-8372-2e65f37087f6",
              "name": "body.email",
              "value": "={{ $json.body.email }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        208,
        0
      ],
      "id": "b25b5a03-97c5-4624-b25b-13f09a0fef7d",
      "name": "Save Email"
    }
  ],
  "connections": {
    "User Erasure Request": {
      "main": [
        [
          {
            "node": "Save Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find User": {
      "main": [
        [
          {
            "node": "Extract Row Number",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Row Number": {
      "main": [
        [
          {
            "node": "Check Deletion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete User Row": {
      "main": [
        [
          {
            "node": "Webhook Reply Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Deletion": {
      "main": [
        [
          {
            "node": "Delete User Row",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Webhook Reply Message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook Reply Message": {
      "main": [
        [
          {
            "node": "Send Confirmation Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook Reply Message1": {
      "main": [
        [
          {
            "node": "Send Confirmation Message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Confirmation Message": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Email": {
      "main": [
        [
          {
            "node": "Find User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "a2334ea7-88c0-4c02-a438-03f333c872d0",
  "activeVersionId": null,
  "triggerCount": 0,
  "shared": [
    {
      "updatedAt": "2025-10-16T00:59:47.839Z",
      "createdAt": "2025-10-16T00:59:47.839Z",
      "role": "workflow:owner",
      "workflowId": "yZzlCGfBVBt4C51h",
      "projectId": "HHopAZ4lOFgjhBzT"
    }
  ],
  "activeVersion": null,
  "tags": []
}